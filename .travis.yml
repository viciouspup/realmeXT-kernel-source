language: C
dist: trusty

before_install:
  
  # Importent Build-Config
  - export DEVICE=RMX1921
  - export TCLINK=https://github.com/djb77/aarch64-linux-android-4.9
  - export OFOLDER=$PWD/arch/arm64/boot
  ##
  - git clone $TCLINK toolchain
  - export ARCH=arm64
  - export CROSS_COMPILE=${PWD}/toolchain/bin/aarch64-linux-android-
  - sudo apt-get -qq update
  - sudo apt-get install -y git ccache automake flex lzop bison \ gperf build-essential zip curl zlib1g-dev zlib1g-dev:i386 \ g++-multilib python-networkx libxml2-utils bzip2 libbz2-dev \ libbz2-1.0 libghc-bzlib-dev squashfs-tools pngcrush \ schedtool dpkg-dev liblz4-tool make optipng maven libssl-dev \ pwgen libswitch-perl policycoreutils minicom libxml-sax-base-perl \ libxml-simple-perl bc libc6-dev-i386 lib32ncurses5-dev \ x11proto-core-dev libx11-dev lib32z-dev libgl1-mesa-dev xsltproc unzip

# we're not installing anything

install: true

script:
  # compiling commands (main)
  - make ranchu64_defconfig
  - make
  # this part uploads output to a cloud
  - cd $OFOLDER
  - echo "Uploading Output" && curl --upload-file zImage https://transfer.sh

deploy:
  provider: releases
  file: "$OFOLDER/zImage"
  cleanup: true
  on:
#tags: true
#all_branches: true
